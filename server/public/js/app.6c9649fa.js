(function(t){function e(e){for(var a,r,o=e[0],c=e[1],u=e[2],l=0,d=[];l<o.length;l++)r=o[l],s[r]&&d.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);f&&f(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,r=1;r<n.length;r++){var o=n[r];0!==s[o]&&(a=!1)}a&&(i.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},r={app:0},s={app:0},i=[];function o(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-0b139997":"766018fd","chunk-19c5cb74":"afd9ca0a","chunk-2203c35a":"73981f20","chunk-24564301":"0179a5be","chunk-293423c0":"304568e4","chunk-3275d745":"c9d794cf","chunk-7051ebc8":"732f7d1f"}[t]+".js"}function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-0b139997":1,"chunk-19c5cb74":1,"chunk-2203c35a":1,"chunk-24564301":1,"chunk-293423c0":1,"chunk-3275d745":1,"chunk-7051ebc8":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise(function(e,n){for(var a="css/"+({}[t]||t)+"."+{"chunk-0b139997":"619bfc07","chunk-19c5cb74":"42320702","chunk-2203c35a":"ab1682c3","chunk-24564301":"8d57a94c","chunk-293423c0":"031ba997","chunk-3275d745":"8421f75c","chunk-7051ebc8":"f640789e"}[t]+".css",s=c.p+a,i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var u=i[o],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===s))return e()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],l=u.getAttribute("data-href");if(l===a||l===s)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var a=e&&e.target&&e.target.src||s,i=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=a,delete r[t],f.parentNode.removeChild(f),n(i)},f.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(f)}).then(function(){r[t]=0}));var a=s[t];if(0!==a)if(a)e.push(a[2]);else{var i=new Promise(function(e,n){a=s[t]=[e,n]});e.push(a[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=o(t),u=function(e){l.onerror=l.onload=null,clearTimeout(d);var n=s[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,i=new Error("Loading chunk "+t+" failed.\n("+a+": "+r+")");i.type=a,i.request=r,n[1](i)}s[t]=void 0}};var d=setTimeout(function(){u({type:"timeout",target:l})},12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var f=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("64a9"),r=n.n(a);r.a},1316:function(t,e,n){},"3a03":function(t,e,n){},"4cc3":function(t,e,n){"use strict";var a=n("cc45"),r=n.n(a);r.a},5113:function(t,e,n){t.exports=n.p+"img/resto.81ed0c78.png"},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},s=[],i=(n("4917"),{created:function(){var t=document.cookie.match("(^|;) ?token=([^;]*)(;|$)"),e=t?t[2]:null;e&&(this.$store.commit("isConnected"),this.$store.dispatch("getInfo"))},mounted:function(){var t=this,e=localStorage.getItem("cookies");e||this.$snackbar.open({message:"Pour assurer une bonne expérience de navigation, ce site utilise des cookies.",type:"is-warning",position:"is-bottom",actionText:"J'ai compris",indefinite:!0,onAction:function(){localStorage.setItem("cookies","ok"),t.$toast.open({message:"Préférences enregistrées",queue:!1})}})}}),o=i,c=(n("034f"),n("2877")),u=Object(c["a"])(o,r,s,!1,null,null,null),l=u.exports,d=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("app-navbar"),n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column",attrs:{id:"displayStores"}},[n("app-list-resto")],1)])])],1)},p=[],h=n("d178"),v=n("ab39"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ul",{staticClass:"columns",attrs:{id:"storeDemo"}},t._l(t.stores,function(e,a){return n("div",{key:a,staticClass:"column is-one-third"},[n("div",{staticClass:"card"},[n("router-link",{staticClass:"card-image",attrs:{tag:"div",to:"/store/"+e._id}},[n("figure",{staticClass:"image is-5by4"},[n("img",{attrs:{src:"/api/store/avatar/"+e._id+"/"+e.photos[0].name,alt:"Placeholder image"}})])]),n("div",{staticClass:"card-content"},[n("div",{staticClass:"media"},[n("div",{staticClass:"media-content"},[n("p",{staticClass:"title is-4",staticStyle:{"text-transform":"uppercase"}},[t._v(t._s(e.name))]),n("p",{staticClass:"subtitle is-6"},t._l(e.tags,function(e,a){return n("span",{key:a,staticClass:"tag is-light",attrs:{id:"card-tag"}},[t._v(t._s(e))])}),0)])]),n("div",{staticClass:"content"},[t._v("\n            "+t._s(e.description.substring(0,40)+"...")+"\n            "),n("br"),n("router-link",{staticClass:"has-text-centered",attrs:{tag:"div",to:"/store/"+e._id}},[n("button",{staticClass:"button is-primary"},[t._v("Voir le restaurant")])])],1)])],1)])}),0),n("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"0","infinite-scroll-immediate-check":"false","infinite-scroll-throttle-delay":"500"}}),n("b-loading",{attrs:{"is-full-page":t.isFullPage,active:t.isLoading,"can-cancel":!0},on:{"update:active":function(e){t.isLoading=e}}})],1)},g=[],b={data:function(){return{isLoading:!1,isFullPage:!0,busy:!1}},mounted:function(){0===this.stores.length&&(this.busy=!0,this.$store.state.page=1,this.getData(1))},methods:{getData:function(t){var e=this;this.isLoading=!0,this.$store.dispatch("storeInfo",t).then(function(){e.$store.commit("page"),e.busy=!1,e.isLoading=!1}).catch(function(t){e.displayError(t),e.isLoading=!1,e.busy=!1})},displayError:function(t){this.$toast.open({message:t,type:"is-danger",position:"is-bottom",duration:4e3})},loadMore:function(){this.busy=!0,this.getData(this.page)}},computed:{stores:function(){return this.$store.getters.stores},reloadStores:function(){return this.$store.state.reloadStores},page:function(){return this.$store.state.page}}},C=b,k=(n("964a"),Object(c["a"])(C,m,g,!1,null,"3c7e1050",null)),y=k.exports,_={name:"home",components:{"app-navbar":h["a"],"app-tags":v["a"],"app-list-resto":y},data:function(){return{}}},w=_,x=(n("d807"),Object(c["a"])(w,f,p,!1,null,"12815ee6",null)),S=x.exports,P=(n("a481"),n("7f7f"),n("ac6a"),n("2f62")),O=n("bc3a"),j=n.n(O);n("3e8f");a["default"].use(P["a"]);var $=new P["a"].Store({state:{isConnected:null,user:{},avatarKey:0,stores:[],reloadStores:!1,page:1},getters:{isConnected:function(t){return t.isConnected},userInfo:function(t){return t.user},stores:function(t){return t.stores},page:function(t){return t.page}},mutations:{isConnected:function(t){t.isConnected=!0},logout:function(t){t.isConnected=!1},userInfo:function(t,e){t.user=e},updateInfo:function(t,e){Object.assign(t.user,e)},updateStores:function(t,e){e.forEach(function(e){t.stores.push(e)})},page:function(t){t.page+=1}},actions:{signup:function(t,e){var n=t.dispatch,a=t.commit;return new Promise(function(t,r){j.a.post("/api/user/inscription",e).then(function(e){e.data.redirectUrl?(t("Bienvenue ".concat(e.data.name," !")),a("isConnected"),n("getInfo")):r(e.data.error)}).catch(function(t){return console.log(t)})})},login:function(t,e){var n=t.commit;return new Promise(function(t,a){j.a.post("/api/user/login",e).then(function(e){e.data.redirectUrl?(n("isConnected"),n("userInfo",e.data),t("Bienvenu ".concat(e.data.name," !")),E.replace("".concat(e.data.redirectUrl))):a(e.data.error)}).catch(function(t){return console.log(t)})})},logout:function(t){var e=t.commit;localStorage.removeItem("cookies"),j.a.get("/api/user/logout").then(function(t){e("logout")}).catch(function(t){return console.log(t)})},getInfo:function(t){var e=t.commit;j.a.get("/api/user/info").then(function(t){t.data.error?e("error",t.data.error):e("userInfo",t.data)}).catch(function(t){return console.log(t)})},patchInfo:function(t,e){var n=t.dispatch;return new Promise(function(t,a){j.a.patch("/api/user/info",e).then(function(e){e.data.error?a(e.data.error):(n("getInfo"),t(e.data.success))}).catch(function(t){return console.log(t)})})},storeInfo:function(t,e){var n=t.commit;return new Promise(function(t,a){j.a.get("/api/store/info/".concat(e)).then(function(e){e.data.error?a(e.data.error):(n("updateStores",e.data.success),t("ok"))}).catch(function(t){return a(t)})})}}});a["default"].use(d["a"]);var E=new d["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:S},{path:"/inscription",name:"inscription",component:function(){return n.e("chunk-24564301").then(n.bind(null,"ec9f"))}},{path:"/connexion",name:"connexion",component:function(){return n.e("chunk-7051ebc8").then(n.bind(null,"c74e"))}},{path:"/top",name:"top",component:function(){return n.e("chunk-2203c35a").then(n.bind(null,"ec27"))}},{path:"/ajouter",name:"ajouter",component:function(){return n.e("chunk-293423c0").then(n.bind(null,"b75f"))},beforeEnter:function(t,e,n){$.state.isConnected?n():n("/connexion")}},{path:"/profil",name:"profil",component:function(){return n.e("chunk-0b139997").then(n.bind(null,"2768"))}},{path:"/store/:id",name:"profil",component:function(){return n.e("chunk-19c5cb74").then(n.bind(null,"2c25"))}},{path:"/test",name:"test",component:function(){return n.e("chunk-3275d745").then(n.bind(null,"78c1"))}},{path:"*",name:"redirect",redirect:"/"}]}),I=(n("5abe"),n("ecee")),T=n("c074"),A=n("ad3d"),D=n("8a03"),L=n.n(D),B=n("755e"),N=n("7bb1"),q=n("487a"),F=n.n(q),K=n("0a63"),M=n.n(K);I["c"].add(T["b"],T["a"]),a["default"].component("vue-fontawesome",A["a"]),a["default"].use(L.a,{defaultIconComponent:"vue-fontawesome",defaultIconPack:"fas"}),a["default"].use(B,{load:{key:"AIzaSyDZxkXKqP5Kc1ynp7fYW8S3Jrelj3ePrC0",libraries:"places"}}),a["default"].use(N["a"]),a["default"].use(F.a),a["default"].use(M.a),a["default"].config.productionTip=!1,new a["default"]({router:E,store:$,render:function(t){return t(l)}}).$mount("#app")},"64a9":function(t,e,n){},"964a":function(t,e,n){"use strict";var a=n("3a03"),r=n.n(a);r.a},ab39:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[n("a",{staticClass:"navbar-link"},[t._v("\n        Tags\n      ")]),n("div",{staticClass:"navbar-dropdown"},[n("p",{staticClass:"navbar-item"},[t._v("\n          Sélectionnez un ou plusieurs critères\n        ")]),n("hr",{staticClass:"navbar-divider"}),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Wi-fi")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Chic")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Convivial")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Gastronomique")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Vegan ")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Branché")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Romantique")])],1)]),n("div",{staticClass:"navbar-item"},[n("span",{on:{click:t.selectTags}},[n("b-switch",{attrs:{value:!1}},[t._v("Cuisine à thème")])],1)])])])])},r=[],s=(n("6762"),n("2fdb"),{data:function(){return{tags:{wifi:"",groupes:""},array:[]}},methods:{selectTags:function(t){var e="";e=t.target.textContent?t.target.textContent:t.target.nextSibling.nextElementSibling.textContent,this.array.includes(e)?this.array.splice(this.array.indexOf(e),1):this.array.push(e),this.$router.push("/")}},watch:{array:function(t){console.log(t)}}}),i=s,o=(n("4cc3"),n("2877")),c=Object(o["a"])(i,a,r,!1,null,"8a50ccdc",null);e["a"]=c.exports},c11a:function(t,e,n){},c9fa:function(t,e,n){},ca3f:function(t,e,n){"use strict";var a=n("d225"),r=n("b0b4"),s=n("bc3a"),i=n.n(s),o=function(){function t(){Object(a["a"])(this,t)}return Object(r["a"])(t,null,[{key:"searchStore",value:function(t){return new Promise(function(e,n){i.a.get("/api/store/search/".concat(t)).then(function(t){t.data.error?n(t.data.error):e(t.data.success)}).catch(function(t){return n(t)})})}},{key:"getSearchStore",value:function(t){return new Promise(function(e,n){i.a.get("/api/store/search/info/".concat(t)).then(function(t){e(t.data.success)}).catch(function(t){return n(t)})})}},{key:"addStore",value:function(t){return new Promise(function(e,n){i.a.post("/api/store/add",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){t.data.error?n(t.data.error):e(t.data.success)}).catch(function(t){return n(t)})})}},{key:"postAvatar",value:function(t){return new Promise(function(e,n){i.a.post("/api/user/avatar",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){t.data.error?n(t.data.error):e(t.data.success)}).catch(function(t){return console.log(t)})})}},{key:"patchPassword",value:function(t){return new Promise(function(e,n){i.a.patch("/api/user/password",t).then(function(t){t.data.error?n(t.data.error):e(t.data.success)}).catch(function(t){return n(t)})})}},{key:"patchDeleteAvatar",value:function(){return new Promise(function(t,e){i.a.patch("/api/user/avatar").then(function(n){n.data.error?e(n.data.error):t(n.data.success)}).catch(function(t){return console.log(t)})})}},{key:"deleteUser",value:function(t){return new Promise(function(e,n){i.a.delete("/api/user/delete/".concat(t)).then(function(t){t.data.error?n(t.data.error):e(t.data.redirect)}).catch(function(t){return console.log(t)})})}}]),t}();e["a"]=o},cc45:function(t,e,n){},d178:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav",{staticClass:"navbar is-transparent is-fixed-top has-shadow is-spaced",attrs:{role:"navigation","aria-label":"main navigation"}},[a("div",{staticClass:"navbar-brand"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[a("img",{attrs:{src:n("5113")}})]),a("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[a("p",{attrs:{id:"name"}},[t._v("DELICIOUS")])]),a("a",{staticClass:"navbar-burger burger",class:{"is-active":t.isActive},attrs:{role:"button","aria-expanded":"false","data-target":"navbarBasicExample"},on:{click:function(e){t.isActive=!t.isActive}}},[a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}})])],1),a("div",{staticClass:"navbar-menu",class:{"is-active":t.isActive,"animated fadeIn":t.isActive},attrs:{id:"navbarBasicExample"}},[a("div",{staticClass:"navbar-start"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[t._v("Restaurants")]),a("app-tags-selector"),a("router-link",{staticClass:"navbar-item",attrs:{to:"/top"}},[a("i",{staticClass:"fas fa-crown"}),t._v("Top\n        ")]),a("router-link",{staticClass:"navbar-item",attrs:{to:"/ajouter"}},[t._v("Ajouter")]),a("router-link",{staticClass:"navbar-item",attrs:{to:"/carte"}},[t._v("Carte")])],1),a("div",{staticClass:"navbar-end"},[a("div",{staticClass:"navbar-item",attrs:{id:"searchBox"}},[a("app-autocomplete")],1),t.isConnected?a("b-tooltip",{attrs:{label:"Cliquez pour ouvrir le menu",position:"is-left"}},[a("router-link",{attrs:{to:"/profil",tag:"div"}},[a("figure",{key:t.componentKey,staticClass:"image is-64x64"},[a("img",{staticClass:"is-rounded click",attrs:{src:"/api/user/avatar"}})])])],1):t._e(),a("div",{staticClass:"navbar-item"},[a("div",{staticClass:"buttons"},[t.isConnected?t._e():a("router-link",{staticClass:"button is-light",attrs:{to:"/connexion"}},[t._v("Connexion")]),t.isConnected?t._e():a("router-link",{staticClass:"button is-primary",attrs:{to:"/inscription"}},[t._v("S'inscrire")]),t.isConnected?a("router-link",{staticClass:"button is-primary",attrs:{tag:"a",to:"/"},nativeOn:{click:function(e){return t.logout(e)}}},[t._v("Déconnexion")]):t._e()],1)])],1)])])])},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-field",[n("b-autocomplete",{attrs:{placeholder:"L'Auberge...","keep-first":t.keepFirst,"open-on-focus":t.openOnFocus,data:t.filteredDataObj,field:"name"},on:{select:function(e){return t.test(e.id)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[n("template",{slot:"empty"},[t._v("No results found")])],2)],1)],1)},i=[],o=(n("ac4d"),n("8a81"),n("ac6a"),n("7f7f"),n("ca3f")),c={data:function(){return{data:[],keepFirst:!1,openOnFocus:!1,name:"",selected:null}},methods:{test:function(t){this.$router.push({path:"/store/".concat(t)})}},computed:{filteredDataObj:function(){return this.data.filter(function(t){return t.name})}},watch:{selected:function(t){null!==t&&console.log(t)},name:function(t){var e=this;null!==t&&o["a"].searchStore(t).then(function(t){var n=!0,a=!1,r=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value;console.log(o),e.data.push(o)}}catch(c){a=!0,r=c}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}}).catch(function(t){return console.log(t)})}}},u=c,l=(n("e2d5"),n("2877")),d=Object(l["a"])(u,s,i,!1,null,null,null),f=d.exports,p=n("ab39"),h={name:"Navbar",components:{"app-autocomplete":f,"app-tags-selector":p["a"]},data:function(){return{isActive:!1,mouveOverAvatar:!1}},computed:{isConnected:function(){return this.$store.getters.isConnected},componentKey:function(){return this.$store.state.avatarKey}},methods:{logout:function(){this.$store.dispatch("logout")}}},v=h,m=(n("d979"),Object(l["a"])(v,a,r,!1,null,"481a95de",null));e["a"]=m.exports},d807:function(t,e,n){"use strict";var a=n("c9fa"),r=n.n(a);r.a},d979:function(t,e,n){"use strict";var a=n("c11a"),r=n.n(a);r.a},e2d5:function(t,e,n){"use strict";var a=n("1316"),r=n.n(a);r.a}});
//# sourceMappingURL=app.6c9649fa.js.map